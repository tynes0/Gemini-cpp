\doxysection{function\+\_\+utils.\+h}
\hypertarget{function__utils_8h_source}{}\label{function__utils_8h_source}\index{gemini/internal/function\_utils.h@{gemini/internal/function\_utils.h}}
\mbox{\hyperlink{function__utils_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{preprocessor}{\#pragma\ once}}
\DoxyCodeLine{00002\ }
\DoxyCodeLine{00003\ \textcolor{preprocessor}{\#ifndef\ GEMINI\_FUNCTION\_UTILS\_H}}
\DoxyCodeLine{00004\ \textcolor{preprocessor}{\#define\ GEMINI\_FUNCTION\_UTILS\_H}}
\DoxyCodeLine{00005\ }
\DoxyCodeLine{00006\ \textcolor{preprocessor}{\#include\ <string>}}
\DoxyCodeLine{00007\ \textcolor{preprocessor}{\#include\ <vector>}}
\DoxyCodeLine{00008\ \textcolor{preprocessor}{\#include\ <tuple>}}
\DoxyCodeLine{00009\ \textcolor{preprocessor}{\#include\ <type\_traits>}}
\DoxyCodeLine{00010\ \textcolor{preprocessor}{\#include\ <nlohmann/json.hpp>}}
\DoxyCodeLine{00011\ }
\DoxyCodeLine{00012\ \textcolor{preprocessor}{\#include\ "{}frenum.h"{}}\ }
\DoxyCodeLine{00013\ }
\DoxyCodeLine{00014\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespace_gemini_c_p_p_1_1_internal}{GeminiCPP::Internal}}}
\DoxyCodeLine{00015\ \{}
\DoxyCodeLine{00020\ \ \ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{00021\ \ \ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_gemini_c_p_p_1_1_internal_1_1_json_type_traits}{JsonTypeTraits}};}
\DoxyCodeLine{00022\ }
\DoxyCodeLine{00026\ \ \ \ \ \textcolor{keyword}{template}\ <>}
\DoxyCodeLine{00027\ \ \ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_gemini_c_p_p_1_1_internal_1_1_json_type_traits}{JsonTypeTraits}}<std::string>}
\DoxyCodeLine{00028\ \ \ \ \ \{}
\DoxyCodeLine{00029\ \ \ \ \ \ \ \ \ \textcolor{keyword}{static}\ nlohmann::json\ \mbox{\hyperlink{struct_gemini_c_p_p_1_1_internal_1_1_json_type_traits_3_01std_1_1string_01_4_aed92d3cf206f5eb868d45f203ae6130f}{schema}}()\ \{\ \textcolor{keywordflow}{return}\ \{\{\textcolor{stringliteral}{"{}type"{}},\ \textcolor{stringliteral}{"{}string"{}}\}\};\ \}}
\DoxyCodeLine{00030\ \ \ \ \ \};}
\DoxyCodeLine{00031\ \ \ \ \ }
\DoxyCodeLine{00035\ \ \ \ \ \textcolor{keyword}{template}\ <>}
\DoxyCodeLine{00036\ \ \ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_gemini_c_p_p_1_1_internal_1_1_json_type_traits}{JsonTypeTraits}}<const\ char*>}
\DoxyCodeLine{00037\ \ \ \ \ \{}
\DoxyCodeLine{00038\ \ \ \ \ \ \ \ \ \textcolor{keyword}{static}\ nlohmann::json\ \mbox{\hyperlink{struct_gemini_c_p_p_1_1_internal_1_1_json_type_traits_3_01const_01char_01_5_01_4_a0a757b31e096feaaf51d79058d579d3f}{schema}}()\ \{\ \textcolor{keywordflow}{return}\ \{\{\textcolor{stringliteral}{"{}type"{}},\ \textcolor{stringliteral}{"{}string"{}}\}\};\ \}}
\DoxyCodeLine{00039\ \ \ \ \ \};}
\DoxyCodeLine{00040\ }
\DoxyCodeLine{00044\ \ \ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{00045\ \ \ \ \ \textcolor{keyword}{requires}\ std::is\_integral\_v<T>\ \&\&\ (!std::is\_same\_v<T,\ bool>)}
\DoxyCodeLine{00046\ \ \ \ \ \textcolor{keyword}{struct}\ \mbox{\hyperlink{struct_gemini_c_p_p_1_1_internal_1_1_json_type_traits}{JsonTypeTraits<T>}}}
\DoxyCodeLine{00047\ \ \ \ \ \{}
\DoxyCodeLine{00048\ \ \ \ \ \ \ \ \ \textcolor{keyword}{static}\ nlohmann::json\ \mbox{\hyperlink{struct_gemini_c_p_p_1_1_internal_1_1_json_type_traits_3_01_t_01_4_a86e9038226238a530bf5548cce1332bc}{schema}}()\ \{\ \textcolor{keywordflow}{return}\ \{\{\textcolor{stringliteral}{"{}type"{}},\ \textcolor{stringliteral}{"{}integer"{}}\}\};\ \}}
\DoxyCodeLine{00049\ \ \ \ \ \};}
\DoxyCodeLine{00050\ }
\DoxyCodeLine{00054\ \ \ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{00055\ \ \ \ \ \textcolor{keyword}{requires}\ std::is\_floating\_point\_v<T>}
\DoxyCodeLine{00056\ \ \ \ \ \textcolor{keyword}{struct\ }JsonTypeTraits<T>}
\DoxyCodeLine{00057\ \ \ \ \ \{}
\DoxyCodeLine{00058\ \ \ \ \ \ \ \ \ \textcolor{keyword}{static}\ nlohmann::json\ \mbox{\hyperlink{struct_gemini_c_p_p_1_1_internal_1_1_json_type_traits_3_01_t_01_4_a86e9038226238a530bf5548cce1332bc}{schema}}()\ \{\ \textcolor{keywordflow}{return}\ \{\{\textcolor{stringliteral}{"{}type"{}},\ \textcolor{stringliteral}{"{}number"{}}\}\};\ \}}
\DoxyCodeLine{00059\ \ \ \ \ \};}
\DoxyCodeLine{00060\ }
\DoxyCodeLine{00064\ \ \ \ \ \textcolor{keyword}{template}\ <>}
\DoxyCodeLine{00065\ \ \ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_gemini_c_p_p_1_1_internal_1_1_json_type_traits}{JsonTypeTraits}}<bool>}
\DoxyCodeLine{00066\ \ \ \ \ \{}
\DoxyCodeLine{00067\ \ \ \ \ \ \ \ \ \textcolor{keyword}{static}\ nlohmann::json\ \mbox{\hyperlink{struct_gemini_c_p_p_1_1_internal_1_1_json_type_traits_3_01bool_01_4_a50350e467a06c4d864304b554dbda9cd}{schema}}()\ \{\ \textcolor{keywordflow}{return}\ \{\{\textcolor{stringliteral}{"{}type"{}},\ \textcolor{stringliteral}{"{}boolean"{}}\}\};\ \}}
\DoxyCodeLine{00068\ \ \ \ \ \};}
\DoxyCodeLine{00069\ }
\DoxyCodeLine{00073\ \ \ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{00074\ \ \ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_gemini_c_p_p_1_1_internal_1_1_json_type_traits}{JsonTypeTraits}}<std::vector<T>>}
\DoxyCodeLine{00075\ \ \ \ \ \{}
\DoxyCodeLine{00076\ \ \ \ \ \ \ \ \ \textcolor{keyword}{static}\ nlohmann::json\ \mbox{\hyperlink{struct_gemini_c_p_p_1_1_internal_1_1_json_type_traits_3_01std_1_1vector_3_01_t_01_4_01_4_a512ee7d8aa9236249c10708191979db6}{schema}}()}
\DoxyCodeLine{00077\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00078\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \{}
\DoxyCodeLine{00079\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{\textcolor{stringliteral}{"{}type"{}},\ \textcolor{stringliteral}{"{}array"{}}\},}
\DoxyCodeLine{00080\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{\textcolor{stringliteral}{"{}items"{}},\ \mbox{\hyperlink{struct_gemini_c_p_p_1_1_internal_1_1_json_type_traits}{JsonTypeTraits<T>::schema}}()\}}
\DoxyCodeLine{00081\ \ \ \ \ \ \ \ \ \ \ \ \ \};}
\DoxyCodeLine{00082\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00083\ \ \ \ \ \};}
\DoxyCodeLine{00084\ }
\DoxyCodeLine{00088\ \ \ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{00089\ \ \ \ \ \textcolor{keyword}{requires}\ frenum::is\_frenum\_v<T>}
\DoxyCodeLine{00090\ \ \ \ \ \textcolor{keyword}{struct\ }JsonTypeTraits<T>}
\DoxyCodeLine{00091\ \ \ \ \ \{}
\DoxyCodeLine{00092\ \ \ \ \ \ \ \ \ \textcolor{keyword}{static}\ nlohmann::json\ \mbox{\hyperlink{struct_gemini_c_p_p_1_1_internal_1_1_json_type_traits_3_01_t_01_4_a86e9038226238a530bf5548cce1332bc}{schema}}()}
\DoxyCodeLine{00093\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00094\ \ \ \ \ \ \ \ \ \ \ \ \ nlohmann::json\ enumValues\ =\ nlohmann::json::array();}
\DoxyCodeLine{00095\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ [val,\ name]\ :\ frenum::enum\_data\_registry<T>::type::values)}
\DoxyCodeLine{00096\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00097\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ enumValues.push\_back(name);}
\DoxyCodeLine{00098\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00099\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \{}
\DoxyCodeLine{00100\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{\textcolor{stringliteral}{"{}type"{}},\ \textcolor{stringliteral}{"{}string"{}}\},}
\DoxyCodeLine{00101\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{\textcolor{stringliteral}{"{}enum"{}},\ enumValues\}}
\DoxyCodeLine{00102\ \ \ \ \ \ \ \ \ \ \ \ \ \};}
\DoxyCodeLine{00103\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00104\ \ \ \ \ \};}
\DoxyCodeLine{00105\ }
\DoxyCodeLine{00114\ \ \ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{00115\ \ \ \ \ T\ \mbox{\hyperlink{namespace_gemini_c_p_p_1_1_internal_a630c86201e2a08af5618454ab087bdd2}{parseArg}}(\textcolor{keyword}{const}\ nlohmann::json\&\ j,\ \textcolor{keyword}{const}\ std::string\&\ name)}
\DoxyCodeLine{00116\ \ \ \ \ \{}
\DoxyCodeLine{00117\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!j.contains(name))}
\DoxyCodeLine{00118\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00119\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}}
\DoxyCodeLine{00120\ \ \ \ \ \ \ \ \ \ \ \ \ (std::is\_default\_constructible\_v<T>)}
\DoxyCodeLine{00121\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ T\{\};}
\DoxyCodeLine{00122\ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00123\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::runtime\_error(\textcolor{stringliteral}{"{}Missing\ argument:\ "{}}\ +\ name);}
\DoxyCodeLine{00124\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00125\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00126\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}\ (frenum::is\_frenum\_v<T>)}
\DoxyCodeLine{00127\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00128\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ val\ =\ frenum::cast<T>(j.at(name).get<std::string>());}
\DoxyCodeLine{00129\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(val)}
\DoxyCodeLine{00130\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ *val;}
\DoxyCodeLine{00131\ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00132\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::runtime\_error(\textcolor{stringliteral}{"{}Invalid\ enum\ value\ for:\ "{}}\ +\ name);}
\DoxyCodeLine{00133\ \ \ \ \ \ \ \ \ \}\ }
\DoxyCodeLine{00134\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00135\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00136\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ j.at(name).get<T>();}
\DoxyCodeLine{00137\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00138\ \ \ \ \ \}}
\DoxyCodeLine{00139\ }
\DoxyCodeLine{00140\ \ \ \ \ \textcolor{comment}{//\ Helper\ implementation\ for\ converting\ JSON\ to\ Tuple}}
\DoxyCodeLine{00141\ \ \ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ TupleType,\ std::size\_t...\ Is>}
\DoxyCodeLine{00142\ \ \ \ \ TupleType\ \mbox{\hyperlink{namespace_gemini_c_p_p_1_1_internal_a5f6026e2e675dfced9232e108e8048f3}{jsonToTupleImpl}}(\textcolor{keyword}{const}\ nlohmann::json\&\ j,\ \textcolor{keyword}{const}\ std::vector<std::string>\&\ argNames,\ std::index\_sequence<Is...>)\ }
\DoxyCodeLine{00143\ \ \ \ \ \{}
\DoxyCodeLine{00144\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ std::make\_tuple(\mbox{\hyperlink{namespace_gemini_c_p_p_1_1_internal_a630c86201e2a08af5618454ab087bdd2}{parseArg}}<std::tuple\_element\_t<Is,\ TupleType>>(j,\ argNames[Is])...);}
\DoxyCodeLine{00145\ \ \ \ \ \}}
\DoxyCodeLine{00146\ }
\DoxyCodeLine{00154\ \ \ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ TupleType>}
\DoxyCodeLine{00155\ \ \ \ \ TupleType\ \mbox{\hyperlink{namespace_gemini_c_p_p_1_1_internal_a943063159a5c8a1ba7b272dd3aa0563e}{jsonToTuple}}(\textcolor{keyword}{const}\ nlohmann::json\&\ j,\ \textcolor{keyword}{const}\ std::vector<std::string>\&\ argNames)\ }
\DoxyCodeLine{00156\ \ \ \ \ \{}
\DoxyCodeLine{00157\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{namespace_gemini_c_p_p_1_1_internal_a5f6026e2e675dfced9232e108e8048f3}{jsonToTupleImpl<TupleType>}}(j,\ argNames,\ std::make\_index\_sequence<std::tuple\_size\_v<TupleType>>\{\});}
\DoxyCodeLine{00158\ \ \ \ \ \}}
\DoxyCodeLine{00159\ \}}
\DoxyCodeLine{00160\ }
\DoxyCodeLine{00161\ \textcolor{preprocessor}{\#endif}}

\end{DoxyCode}
